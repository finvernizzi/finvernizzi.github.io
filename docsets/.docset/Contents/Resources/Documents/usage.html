<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Usage  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Usage  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
           1.0 Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html"> Reference</a>
      <img class="carat" src="img/carat.png" />
      Usage  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="usage.html">Usage</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MetricsManager.html">MetricsManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QPEngine.html">QPEngine</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QPSettings.html">QPSettings</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QPSignal.html">QPSignal</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QPSignalMessage.html">QPSignalMessage</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/QPApiDomain.html">QPApiDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/QPLangCode.html">QPLangCode</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CLLocationCoordinate2D.html">CLLocationCoordinate2D</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/QPEvent.html">QPEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/QPManagerDelegate.html">QPManagerDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPConnectivityChangedEvent.html">QPConnectivityChangedEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPEngineStarted.html">QPEngineStarted</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPEnteredVSignEvent.html">QPEnteredVSignEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPExitedApiCoverageRegionEvent.html">QPExitedApiCoverageRegionEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPGPSUpdatesPaused.html">QPGPSUpdatesPaused</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPLocationUpdatedEvent.html">QPLocationUpdatedEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPNotifiedVSignEvent.html">QPNotifiedVSignEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPResetVSignStatus.html">QPResetVSignStatus</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/QPVSignsFetchedEvent.html">QPVSignsFetchedEvent</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:14QuandoPassoLib16VSignScanResultsa">VSignScanResults</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='how-to-integrate-the-quandopasso-sdk-into-your-application' class='heading'>How to integrate the Quandopasso SDK into your application</h1>
<h2 id='preliminary-notes-and-general-requirements' class='heading'>Preliminary notes and general requirements</h2>

<p>Quandopasso SDK has been implemented in Swift and can be integrated as a Framework in both
Swift and Objective C projects.</p>

<p>The SDK depends on the following packages, which nned to be installed into the main project using the dependency manager of your choice.</p>

<p>The following is a Carthage file with the dependency package names along with the required versions:</p>
<pre class="highlight plaintext"><code>github "xmartlabs/Eureka" ~&gt; 5.0
github "ReactiveX/RxSwift" ~&gt; 5.0
github "Alamofire/Alamofire" ~&gt; 4.8
github "emaloney/CleanroomLogger" ~&gt; 6.0.0
github "hkellaway/Gloss"
github "rwbutler/Connectivity"
</code></pre>

<p>The released QuandoPassoLib.framework file can then be linked to your Xcode project from the <q>Linked Frameworks and Library</q> section in the General settings, along with the dependency libraries listed above and any other dependency your project may have.</p>
<h2 id='usage' class='heading'>Usage</h2>
<h3 id='initialise-and-start-the-qpengine-instance' class='heading'>Initialise and start the QPEngine instance</h3>

<p>After you link QuandoPassoLib.framework to your XCode project, the first step to use its functionalities is to create an instance
of the <code><a href="Classes/QPEngine.html">QPEngine</a></code> class, optionally passing to the constructor a <code><a href="Classes/QPSettings.html">QPSettings</a></code> object to control its behaviour.</p>

<p>Then, you can call the <code>askPermission()</code> method to require the needed permissions in order to use the GPS and
the Notifications modules.</p>

<p>Finally, you can call the <code>start()</code> method to start the QPEngine, which will in turn start tracking location updates using 
the GPS module, fetching vSigns from the Quandopasso API, and emitting events when vSigns are entered.</p>

<p>The example usage below is written in Swift, but the same concepts apply in Objective C:</p>
<pre class="highlight plaintext"><code>override func viewDidLoad() {
    super.viewDidLoad()

    let qpEngine = QPEngine()

    qpEngine.askPermission()
    qpEngine.start()
}
</code></pre>
<h3 id='how-to-receive-event-notifications-and-implement-your-custom-app-logic' class='heading'>How to receive event notifications and implement your custom app logic</h3>

<p>The QuandoPasso SDK uses the popular Delegate pattern to let you perform custom logic for the events you care about.</p>

<p>As an example, this is how you would use the Delegate pattern to perform some custom actions:</p>
<pre class="highlight plaintext"><code>
// Note that our view implements the QPManagerDelegate protocol
class ViewController: UIViewController, QPManagerDelegate {

    override func viewDidLoad() {
        super.viewDidLoad()

        let qpEngine = QPEngine()

        // This line sets the delegate object to the current class, so that the qpManager method gets called by the SDK.
        // To make sure no events gets lost, it is recommended to always set the delegate before calling the .start() method.
        qpEngine.delegate = self

        qpEngine.askPermission()
        qpEngine.start()
    }

    // This is the delegate method called when noteworthy events are emitted by the Quandopasso SDK.    
    func qpManager(event: QPEvent) {
        switch event {
        case let ev as QPNotifiedVSignEvent:
            print("User entered vSign with id \(ev.signal.id)")
        case let ev as QPLocationUpdatedEvent:
            print("User location updated. New location: \(ev.currentLocation)")
        default:
            return
        }
    }
}

</code></pre>

<p>The following events are emitted by the Quandopasso SDK:</p>

<ul>
<li><p><code><a href="Structs/QPEngineStarted.html">QPEngineStarted</a></code>: triggered when the Engine receives the first GPS update, which is required to perform the initial operations.</p></li>
<li><p><code><a href="Structs/QPConnectivityChangedEvent.html">QPConnectivityChangedEvent</a></code>: triggered when the network status changes, e.g. from <q>connected</q> to <q>disconnected</q>.</p></li>
<li><p><code><a href="Structs/QPLocationUpdatedEvent.html">QPLocationUpdatedEvent</a></code>: triggered when the Engine receives a GPS update from the system module.</p></li>
<li><p><code><a href="Structs/QPEnteredVSignEvent.html">QPEnteredVSignEvent</a></code>: triggered when the Engine detects the user has entered a VSign.</p></li>
<li><p><code><a href="Structs/QPNotifiedVSignEvent.html">QPNotifiedVSignEvent</a></code>: triggered when a VSign has been notified to the user.</p></li>
<li><p><code><a href="Structs/QPVSignsFetchedEvent.html">QPVSignsFetchedEvent</a></code>: triggered when the Engine fetches the list of vSigns from the API.</p></li>
<li><p><code><a href="Structs/QPExitedApiCoverageRegionEvent.html">QPExitedApiCoverageRegionEvent</a></code>: triggered when the Engine detects that the user has exited the circular region coveder by the
latest API call to fetch the relative vSigns.</p></li>
<li><p><code><a href="Structs/QPResetVSignStatus.html">QPResetVSignStatus</a></code>:  triggered when the vSign notified status has been reset.</p></li>
<li><p><code><a href="Structs/QPGPSUpdatesPaused.html">QPGPSUpdatesPaused</a></code>: triggered when iOS notified the Engine that GPS updates have been suspended because of inactivity.</p></li>
</ul>

<p>For details about each specific event and the properties assigned to it, please refer to the code documentation.</p>
<h2 id='settings' class='heading'>Settings</h2>
<h4 id='code-enabletexttospeech-code' class='heading'><code>enableTextToSpeech</code></h4>

<p>Controls if vsign messages are read by the TTS service</p>
<h4 id='code-apibaseurl-code' class='heading'><code>apiBaseUrl</code></h4>
<h4 id='code-apidomain-code' class='heading'><code>apiDomain</code></h4>
<h4 id='code-apipollinterval-code' class='heading'><code>apiPollInterval</code></h4>

<p>Controls how often (in seconds) we poll the API for new vSigns.
Note that apart from polling, vsigns are fetched when the coverage geofence is exited.</p>

<p>Default value: <code>30</code></p>
<h4 id='code-apicoverageradius-code' class='heading'><code>apiCoverageRadius</code></h4>

<p>Value (in meters) passed to the API as the vsign coverage radius. A value of <code>1000</code> would
ask the API to give us all vsigns in the given radius.</p>

<p>Default value: <code>5000</code></p>
<h4 id='code-bearingtolerancedegrees-code' class='heading'><code>bearingToleranceDegrees</code></h4>

<p>Value in degrees controlling the tolerance for the angle used to detect the entering direction for a vsign</p>

<p>Default value: <code>60</code></p>
<h4 id='code-enablebearingchecks-code' class='heading'><code>enableBearingChecks</code></h4>

<p>Controls if the entering angle should be used when detecting if a visgin is being entered</p>

<p>Default value:  <code>true</code></p>
<h4 id='code-gpslocationmaxageseconds-code' class='heading'><code>gpsLocationMaxAgeSeconds</code></h4>

<p>GPS updates older than this value (in seconds) will be discarded as outdated.
Useful to discard out of date locations when the GPS doesn&rsquo;t work properly.</p>

<p>Default value: <code>10</code></p>
<h4 id='code-gpslocationminhorizontalaccuracy-code' class='heading'><code>gpsLocationMinHorizontalAccuracy</code></h4>

<p>GPS updates that fall outside of this accurancy range (in meters) will be discarded as too inaccurate to be used.
Default value: <code>100</code></p>
<h4 id='code-notifiedtimeoutseconds-code' class='heading'><code>notifiedTimeoutSeconds</code></h4>

<p>Notified vSigns will be re-notified again once re-entered if the previous notification is older than
this value (in seconds)</p>

<p>Default value: <code>180</code></p>
<h4 id='code-notifiedmindistanceinmeters-code' class='heading'><code>notifiedMinDistanceInMeters</code></h4>

<p>Notified vSigns will be re-notified again once re-entered if the user has reached this min distance (in meters)
from the vsign area.</p>

<p>Default value: <code>2000</code></p>
<h4 id='code-ttsvolume-code' class='heading'><code>ttsVolume</code></h4>

<p>Volume for the TTS messages</p>

<p>Default value:  <code>1.0</code></p>
<h4 id='code-language-code' class='heading'><code>language</code></h4>

<p>Language used to display and read vsign messages</p>
<h4 id='code-syncmetricsinterval-code' class='heading'><code>syncMetricsInterval</code></h4>

<p>Controls how often (in seconds) buffered metrics are sent to the API</p>

<p>Default value: <code>300</code></p>
<h4 id='code-gpsdefaultaccuracy-code' class='heading'><code>gpsDefaultAccuracy</code></h4>

<p>Controls how often buffered metrics are sent to the API</p>

<p>Default value: <code>.kCLLocationAccuracyBestForNavigation</code></p>
<h4 id='code-gpspauseslocationupdatesautomatically-code' class='heading'><code>gpsPausesLocationUpdatesAutomatically</code></h4>

<p>Automatically pauses GPS updates if the system determines updates are not strictly requires
(e.g. the user hasn&rsquo;t been moving for a while) to save battery.</p>

<p>Default value: <code>true</code></p>
<h4 id='code-gpsdistancefilter-code' class='heading'><code>gpsDistanceFilter</code></h4>

<p>Controls how often GPS updates are required, based on the user movements.
For example, setting this to <code>5</code> meters will make the system sends GPS update events
only if the user moves outside of a 5 meter radius from their last position.</p>

<p>Default value: <code>5</code></p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="https://www.quandopasso.com" target="_blank" rel="external">Quandopasso - Connected Driving &amp; Road Management System</a>. All rights reserved. (Last updated: 2019-12-19)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.12.0</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
